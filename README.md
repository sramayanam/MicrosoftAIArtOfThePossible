# Microsoft AI Art of the Possible ğŸš€

A comprehensive showcase of **Microsoft AI capabilities** across multiple platforms â€” featuring Power Apps, Copilot Studio, Azure AI Foundry, and Model Context Protocol (MCP) implementations. This repository demonstrates production-ready AI solutions spanning conversational agents, infrastructure as code, and enterprise AI integrations.

## ğŸ“š Repository Overview

This repository contains:
1. **Airlines Analytics Agent** - A Power Apps Code App with React + TypeScript showcasing Copilot Studio integration
2. **EverythingMCP** - Comprehensive MCP server implementations (submodule)
3. **AI Foundry Landing Zone** - Terraform infrastructure for Azure AI Foundry (submodule)
4. **Claude Artifacts** - Claude AI artifact samples (submodule - if accessible)

---

## ğŸ¯ Main Project: Airlines Analytics Agent

A production-ready chat interface for a **Copilot Studio agent** that explores airline industry data (routes, airports, carriers, passengers, revenue) and renders charts â€” built as a Power Apps Code App with React + TypeScript + Vite.

### âœ¨ Features

- **Instant welcome greeting** describing agent capabilities
- **Copilot Studio connector** via `@microsoft/power-apps` SDK
- **Markdown rendering** with tables, bold, lists, and inline images
- **Chart images** rendered inside Power Apps CSP restrictions
- **Sample prompts sidebar** with pre-built airline data queries
- **New Chat** resets conversation without a page reload

### ğŸ›  Tech Stack

| Layer | Technology |
|-------|-----------|
| Framework | React 19 + TypeScript 5.9 |
| Bundler | Vite 7 + `@microsoft/power-apps-vite` |
| Connector SDK | `@microsoft/power-apps` v1.0.3 |
| Markdown | `react-markdown` + `remark-gfm` |
| Platform | Power Apps Code Apps |
| Agent | Copilot Studio â€” Airlines Agent V1 |

### ğŸ“¦ Project Structure

```
src/
â”œâ”€â”€ App.tsx                  # Root â€” renders Header + Chat
â”œâ”€â”€ main.tsx                 # Entry point
â”œâ”€â”€ index.css                # All styles (sidebar, chat, responsive)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Chat.tsx             # Chat orchestrator, welcome message, lazy agent init
â”‚   â”œâ”€â”€ MessageList.tsx      # Message rendering + CSP-safe image processing
â”‚   â”œâ”€â”€ MessageInput.tsx     # Text input + send button
â”‚   â”œâ”€â”€ Header.tsx           # App header bar
â”‚   â””â”€â”€ SamplePrompts.tsx    # Sidebar with clickable sample prompts
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ ChatService.ts       # Interface: startConversation, sendMessage, endConversation
â”‚   â”œâ”€â”€ PowerChatService.ts  # Calls Copilot Studio via connector SDK
â”‚   â””â”€â”€ index.ts             # Barrel exports
â”œâ”€â”€ generated/               # Auto-generated by `pac code add-data-source`
â”‚   â””â”€â”€ index.ts             # Typed service + model for connector operations
â””â”€â”€ types/
    â””â”€â”€ chat.ts              # ChatMessage type
```

### ğŸš€ Getting Started

#### Prerequisites

- Node.js 18+
- PAC CLI (via Power Platform VS Code extension)
- A Power Apps environment with the Copilot Studio connector configured

#### Development

```bash
npm install
npm run dev          # Vite dev server at http://localhost:3000
```

#### Build & Deploy

```bash
npm run build        # TypeScript check + Vite production build â†’ dist/
pac code push        # Deploy to Power Apps
```

### ğŸ— Architecture

The app runs entirely client-side with no backend server. Auth is handled by the Power Apps platform.

#### Data Connector â€” Microsoft Copilot Studio

The app uses the **`shared_microsoftcopilotstudio`** connector, configured in `power.config.json` with a shared connection. The typed service layer is auto-generated by `pac code add-data-source` into `src/generated/`, providing a `MicrosoftCopilotStudioService` class with static methods for all 14 connector operations.

Each method calls `getClient(dataSourcesInfo).executeAsync()` from `@microsoft/power-apps/data`. The SDK resolves the connection reference, authenticates using the user's Power Apps session, and routes calls through the connector's APIM gateway â€” no auth code needed in the app.

**Operation used:**

| Operation | Response |
|-----------|----------|
| `ExecuteCopilotAsyncV2` | `{ responses: string[], conversationId, completed }` |

The call shape:

```typescript
ExecuteCopilotAsyncV2(
  '<your_agent_schema_name>',                   // agent schema name
  { message: '...', notificationUrl: '...' },  // notificationUrl is required but unused
  conversationId?,                              // undefined on first turn
)
```

#### PowerChatService

`PowerChatService` implements the `ChatService` interface (`startConversation`, `sendMessage`, `endConversation`), decoupling the UI from connector details.

Key behaviors:

- **Conversation tracking** â€” Stores `conversationId` across turns. First call goes without one; subsequent calls pass it via `x_ms_conversation_id` so the agent maintains context.
- **Resilient parsing** â€” `parseResponse()` handles three casings of the conversation ID field (`conversationId`, `conversationID`, `ConversationId`) and unwraps `result.data` vs `result` depending on SDK response shape.
- **Lazy initialization** â€” `startConversation()` is deferred to the first user message. The app shows a local welcome message instantly with zero network latency.

#### Chart Rendering

The agent returns chart images as standard markdown (`![alt](https://...)`). These are rendered directly by `react-markdown` as inline `<img>` tags â€” no special processing needed.

---

## ğŸ”— Linked Repositories (Git Submodules)

This repository includes three comprehensive submodules showcasing different aspects of Microsoft AI capabilities:

### 1. EverythingMCP - Model Context Protocol Ecosystem

**Repository**: [github.com/sramayanam/EverythingMCP](https://github.com/sramayanam/EverythingMCP)  
**Path**: `./EverythingMCP/`

A complete enterprise ecosystem for Model Context Protocol (MCP) servers with multiple implementations including PostgreSQL database tools, loan insights API, and Azure AI Foundation integration.

#### Key Components:

##### ğŸ—ƒï¸ Enhanced PostgreSQL MCP Server
- **10 PostgreSQL Tools**: Database inspection, statistics, monitoring, and data preview
- **Enterprise Security**: SQL injection prevention, input validation, read-only operations
- **Performance**: Async connection pooling (5-20 connections), query timeout protection
- **Production Ready**: Structured logging, Kubernetes health probes, Docker containerization

**Tools Available**:
1. `get_databases` - List all databases with size information
2. `get_tables` - List tables with statistics and size info
3. `describe_table` - Detailed table structure and constraints
4. `get_indexes` - Index information for tables
5. `get_table_stats` - Comprehensive table statistics
6. `get_database_size` - Database size analytics
7. `preview_table_data` - Safe data preview (max 10 rows)
8. `count_table_rows` - Accurate row counts
9. `get_active_connections` - Connection monitoring
10. `check_database_health` - System health checks

##### ğŸ’¼ Loan Insights API
RESTful API for loan portfolio analytics with 174,693 loan records:
- **Portfolio Analytics**: Default rates, risk analysis, performance metrics
- **Data Access**: Filtered loan data with pagination
- **Business Insights**: Credit score analysis, risk factors, portfolio performance
- **Key Metrics**: 26.08% overall default rate, credit score impact analysis

##### ğŸ¤– Azure AI Foundation Agent
- **Semantic Kernel Integration**: Azure AI agent framework
- **MCP Tool Configuration**: Automatic tool discovery and execution
- **Tool Approval Handling**: Secure tool execution workflow
- **Enhanced Error Handling**: Comprehensive logging and debugging

##### ğŸ“Š Copilot Studio Configuration
Configuration files for Microsoft Copilot Studio MCP integration including OpenAPI schemas and APIM policies.

**Quick Start**:
```bash
cd EverythingMCP/enhanced-postgresql-mcp
cp .env.example .env
pip install -r requirements.txt
python -m app.main
```

**Docker Deployment**:
```bash
docker build -t enhanced-postgresql-mcp .
docker run -d -p 8000:8000 \
  -e DATABASE_URL="postgresql://user:pass@host:5432/db" \
  enhanced-postgresql-mcp
```

**Learn More**: See [EverythingMCP/README.md](./EverythingMCP/README.md) for comprehensive documentation.

---

### 2. AI Foundry Landing Zone - Azure Infrastructure

**Repository**: [github.com/sramayanam/aifoundrylandingzone](https://github.com/sramayanam/aifoundrylandingzone)  
**Path**: `./aifoundrylandingzone/`

Production-ready Terraform configurations for deploying Azure AI Foundry with private networking and cross-subscription support.

#### Deployment Options:

##### ğŸƒâ€â™‚ï¸ NoCapabilityHosts (Simplified)
Cost-optimized deployment without compute infrastructure:
- âœ… **Lower cost** (~30% reduction vs capability hosts)
- âœ… Azure AI Foundry Hub & Project with GPT-4o model
- âœ… Private networking with private endpoints
- âœ… Cross-subscription support
- âœ… Storage & AI Search integration
- âœ… Monitoring and security

##### ğŸ—ï¸ WithCapabilityHosts (Enterprise)
Complete AI Foundry with Standard Agent support:
- âœ… **Capability hosts** for bring-your-own Azure resources
- âœ… **Cosmos DB** for thread and conversation storage
- âœ… **Agent subnet injection** for network-secured deployments
- âœ… **Standard Agent** runtime support

#### Architecture Components:
- **Azure AI Foundry Hub & Project** - Core AI platform
- **Private Networking** - Secure connectivity with private endpoints
- **Cross-subscription Support** - Separate workload and infrastructure subscriptions
- **Storage & Search** - Integrated storage account and AI search service
- **Monitoring** - Application Insights and diagnostic settings
- **Security** - RBAC, managed identities, and optional Key Vault

#### Required Private DNS Zones:
- `privatelink.cognitiveservices.azure.com`
- `privatelink.openai.azure.com`
- `privatelink.services.ai.azure.com`
- `privatelink.blob.core.windows.net`
- `privatelink.search.windows.net`
- `privatelink.vaultcore.azure.net` (optional, for Key Vault)

**Quick Start**:
```bash
cd aifoundrylandingzone
terraform init
cp terraform.tfvars.example terraform.tfvars
# Edit terraform.tfvars with your configuration
terraform plan
terraform apply
```

**Environment Configuration**:

| Setting | dev | staging | prod |
|---------|-----|---------|------|
| Storage SKU | Standard_LRS | Standard_ZRS | Premium_ZRS |
| Search SKU | basic | standard | standard |
| Backup | disabled | enabled | enabled |
| Monitoring | basic | standard | comprehensive |

**Learn More**: See [aifoundrylandingzone/README.md](./aifoundrylandingzone/README.md) for detailed deployment guides.

---

### 3. Claude Artifacts (Submodule)

**Repository**: [github.com/sramayanam/claudeartifacts](https://github.com/sramayanam/claudeartifacts)  
**Path**: `./claudeartifacts/`

Sample artifacts and examples for Claude AI integration.

*Note: This repository may have restricted access. Check repository availability for details.*

---

## ğŸ—ï¸ Complete Architecture

This repository demonstrates a comprehensive Microsoft AI ecosystem:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Microsoft AI Ecosystem                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Power Apps  â”‚    â”‚   Copilot    â”‚    â”‚  Azure AI    â”‚      â”‚
â”‚  â”‚  Code App    â”‚â—„â”€â”€â”€â”¤   Studio     â”‚    â”‚   Foundry    â”‚      â”‚
â”‚  â”‚  (React)     â”‚    â”‚   Agent      â”‚    â”‚  (Terraform) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â–¼                    â–¼                    â–¼             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              Model Context Protocol (MCP)            â”‚       â”‚
â”‚  â”‚  â€¢ PostgreSQL Servers  â€¢ Loan Insights API          â”‚       â”‚
â”‚  â”‚  â€¢ Azure AI Integration â€¢ Copilot Studio Config     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                  â”‚
â”‚  Infrastructure: Private Networking, RBAC, Monitoring           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Architecture Highlights**:
- **Frontend**: React 19 + TypeScript Power Apps Code App
- **AI Integration**: Copilot Studio with conversational agents
- **Backend**: MCP servers for database access and analytics
- **Infrastructure**: Azure AI Foundry with Terraform IaC
- **Security**: Private endpoints, managed identities, RBAC
- **Monitoring**: Application Insights, Log Analytics

See [AirlinesDemoArchitecture.png](./AirlinesDemoArchitecture.png) for the complete visual architecture diagram.

---

## ğŸš€ Quick Start Guide

### 1. Clone with Submodules

```bash
# Clone the repository with all submodules
git clone --recursive https://github.com/sramayanam/MicrosoftAIArtOfThePossible.git

# Or if already cloned, initialize submodules
git submodule update --init --recursive
```

### 2. Main Application (Power Apps)

```bash
# Install dependencies
npm install

# Run development server
npm run dev

# Build for production
npm run build

# Deploy to Power Apps
pac code push
```

### 3. MCP Servers (EverythingMCP)

```bash
cd EverythingMCP/enhanced-postgresql-mcp
cp .env.example .env
pip install -r requirements.txt
python -m app.main
```

### 4. Infrastructure (AI Foundry Landing Zone)

```bash
cd aifoundrylandingzone
terraform init
cp terraform.tfvars.example terraform.tfvars
# Edit configuration
terraform apply
```

---

## ğŸ“š Documentation

### Main Project Documentation
- **[Power Apps Development](#-getting-started)** - Building and deploying the Code App
- **[Architecture Details](#-architecture)** - Technical architecture and design patterns
- **[Project Structure](#-project-structure)** - Code organization and components

### Submodule Documentation
- **[EverythingMCP README](./EverythingMCP/README.md)** - Complete MCP server documentation
- **[AI Foundry Landing Zone README](./aifoundrylandingzone/README.md)** - Infrastructure deployment guides
- **[Enhanced PostgreSQL MCP](./EverythingMCP/enhanced-postgresql-mcp/)** - Database tools documentation
- **[Loan Insights API](./EverythingMCP/loan-insights-api/)** - Analytics API documentation

---

## ğŸ›  Development Workflow

### Prerequisites
- **Node.js 18+** - For Power Apps development
- **Python 3.11+** - For MCP servers
- **Terraform >= 1.5.0** - For infrastructure deployment
- **Azure CLI** - For Azure resource management
- **PAC CLI** - For Power Platform deployment

### Environment Setup

1. **Power Apps Environment**:
   ```bash
   npm install
   npm run dev
   ```

2. **MCP Server Environment**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # or `venv\Scripts\activate` on Windows
   pip install -r requirements.txt
   ```

3. **Azure Infrastructure**:
   ```bash
   az login
   terraform init
   ```

### Testing

- **Lint**: `npm run lint` - ESLint checks for TypeScript/React
- **Type Check**: `tsc -b` - TypeScript compilation check
- **MCP Tests**: `pytest tests/` - MCP server unit tests

---

## ğŸŒŸ Key Features Across the Ecosystem

### Power Apps Code App
âœ… Chat with Copilot Studio agents  
âœ… Dynamic chart rendering with markdown  
âœ… Sample prompts for quick interactions  
âœ… Conversation persistence across messages  
âœ… Zero-latency welcome experience  

### MCP Ecosystem
âœ… 10+ PostgreSQL database tools  
âœ… Enterprise security with SQL injection prevention  
âœ… Loan portfolio analytics with 174K+ records  
âœ… Azure AI Foundation agent integration  
âœ… Docker and Kubernetes deployment ready  

### Azure Infrastructure
âœ… Private networking with Azure Private Link  
âœ… Cross-subscription deployment support  
âœ… Two deployment options (simplified/enterprise)  
âœ… Comprehensive monitoring and logging  
âœ… RBAC and managed identities  

---

## ğŸ¤ Contributing

Contributions are welcome! Please follow these guidelines:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

For submodule contributions, please refer to the respective repository's contribution guidelines.

---

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

Individual submodules may have their own licenses. Please refer to:
- [EverythingMCP License](./EverythingMCP/LICENSE)
- [AI Foundry Landing Zone License](./aifoundrylandingzone/LICENSE)

---

## ğŸ”— Additional Resources

### Microsoft Documentation
- [Power Apps Documentation](https://docs.microsoft.com/power-apps/)
- [Copilot Studio Documentation](https://docs.microsoft.com/microsoft-copilot-studio/)
- [Azure AI Foundry Documentation](https://docs.microsoft.com/azure/ai-foundry/)
- [Azure OpenAI Service](https://docs.microsoft.com/azure/cognitive-services/openai/)

### Model Context Protocol
- [MCP Specification](https://modelcontextprotocol.io/)
- [MCP Server Development](https://modelcontextprotocol.io/docs/server/)

### Development Tools
- [Power Platform CLI](https://docs.microsoft.com/power-platform/developer/cli/introduction)
- [Terraform Azure Provider](https://registry.terraform.io/providers/hashicorp/azurerm/latest)
- [React Documentation](https://react.dev/)
- [Vite Documentation](https://vitejs.dev/)

---

## ğŸ“ Support

For issues and questions:
- **Main Repository Issues**: [GitHub Issues](https://github.com/sramayanam/MicrosoftAIArtOfThePossible/issues)
- **EverythingMCP Issues**: [EverythingMCP Issues](https://github.com/sramayanam/EverythingMCP/issues)
- **AI Foundry Issues**: [aifoundrylandingzone Issues](https://github.com/sramayanam/aifoundrylandingzone/issues)

---

**ğŸ‰ Built with â¤ï¸ to showcase the Art of the Possible with Microsoft AI**
